(window.webpackJsonp=window.webpackJsonp||[]).push([[4,73],{340:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var r=n(415);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(f,e);var t,n,o,s=c(f);function f(){return a(this,f),s.apply(this,arguments)}return t=f,(n=[{key:"render",value:function(){var e=this.props.errors;return!!e&&Object(r.h)("div",null,e.map((function(e){return Object(r.h)("div",{className:"validation_error"},e)})))}}])&&u(t.prototype,n),o&&u(t,o),f}(r.Component)},341:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(415),o=n(430),a=n.n(o);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",maxWidth:"500px",minWidth:"300px",maxHeight:"100%",overflow:"scroll"}};a.a.setAppElement("#block-probate-machine-5e4575fc217f0");var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(p,e);var t,n,o,u=f(p);function p(){return i(this,p),u.apply(this,arguments)}return t=p,(n=[{key:"render",value:function(){var e=this.props,t=e.title,n=e.content,o=e.respond,u=e.open;return Object(r.h)(a.a,{isOpen:u,onAfterOpen:!!o&&function(e){return o(e,"open")},onRequestClose:!!o&&function(e){return o(e,"closed")},style:d,contentLabel:t},Object(r.h)("div",null,n))}}])&&c(t.prototype,n),o&&c(t,o),p}(r.Component)},356:function(e,t,n){"use strict";function r(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var u=e.apply(t,n);function i(e){r(u,o,a,i,c,"next",e)}function c(e){r(u,o,a,i,c,"throw",e)}i(void 0)}))}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"default",(function(){return s}));var i=new Headers({"content-type":"application/json","X-WP-Nonce":Globals.rest_nonce}),c={template:Globals.api_url+"twig/get-template/",intent:Globals.api_url+"stripe/payment/setup-intent/"},s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"form",{}),u(this,"intent",!1),u(this,"getForm",function(){var e=o(regeneratorRuntime.mark((function e(n,r){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setupIntent(r);case 2:return o={method:"post",mode:"cors",body:JSON.stringify({path:"take-payment",filename:"take-payment.twig",data:{amount:r/100,product:n}}),headers:i},e.next=5,fetch(c.template,o);case 5:return a=e.sent,e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),u(this,"bindForm",function(){var e=o(regeneratorRuntime.mark((function e(n,r){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t.form).find("button[type=submit]").on("click",o(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading(!0),r=a.find("input#card-name").val(),o={error:{}},r=r||!1){e.next=7;break}o.error.message="Add the name on card.",e.next=10;break;case 7:return e.next=9,stripe.confirmCardPayment(t.intent.client_secret,{payment_method:{card:n.cardNumber,billing_details:{name:r,email:Globals.user_logged_in_email}}});case 9:o=e.sent;case 10:t.loading(!1),o.error?a.find(".take-payment__errors").addClass("validation_error").html(o.error.message):document.dispatchEvent(new CustomEvent("payment-accepted"));case 12:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),u(this,"applyStripe",function(){var e=o(regeneratorRuntime.mark((function e(n){var r,o,a,u,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=$(n.contentEl),t.form=n,e.t0=JSON,e.next=5,$.ajax({type:"get",url:Globals.ajax_url,data:{action:"stripe_preload_assets"}});case 5:if(e.t1=e.sent,r=e.t0.parse.call(e.t0,e.t1),"undefined"!=typeof Stripe){e.next=11;break}return e.next=10,$.getScript(r.url);case 10:window.stripe=Stripe(r.key);case 11:o=stripe.elements({locale:"auto"}),u={focus:"focused",empty:"empty",invalid:"invalid"},i={base:{}},(a={}).cardNumber=o.create("cardNumber",{classes:u,style:i}),a.cardNumber.mount(n.find("#card-number")[0]),a.cardExpiry=o.create("cardExpiry",{classes:u,style:i}),a.cardExpiry.mount(n.find("#card-expiry")[0]),a.cardCvc=o.create("cardCvc",{classes:u,style:i}),a.cardCvc.mount(n.find("#card-cvc")[0]),t.card=a,t.elements=o,t.bindForm(t.card,t.elements),t.loading(!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u(this,"setupIntent",function(){var e=o(regeneratorRuntime.mark((function e(n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"post",mode:"cors",body:JSON.stringify({amount:n}),headers:i},e.next=3,fetch(c.intent,r);case 3:return o=e.sent,e.next=6,o.json();case 6:t.intent=e.sent,console.log(t.intent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,n,r;return t=e,(n=[{key:"loading",value:function(e){var t=this.form;e?(t.find(".dpl-take-payment").addClass("hide"),t.find(".spinner").removeClass("hide")):(t.find(".dpl-take-payment").removeClass("hide"),t.find(".spinner").addClass("hide"))}}])&&a(t.prototype,n),r&&a(t,r),e}()},371:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var r=n(415),o=n(340),a=n(356),u=n(341);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){c(a,r,o,u,i,"next",e)}function i(e){c(a,r,o,u,i,"throw",e)}u(void 0)}))}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v={get:Globals.api_url+"pmachine/task-basket/get/",update:Globals.api_url+"pmachine/task-basket/update/"},g=new Headers({"content-type":"application/json","X-WP-Nonce":Globals.rest_nonce}),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(y,e);var t,n,i,c=d(y);function y(){var e;f(this,y);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return h(m(e=c.call.apply(c,[this].concat(n))),"state",{newValue:!1,popup:!1,disable:!1,purchased:!1}),h(m(e),"popupResponse",function(){var t=s(regeneratorRuntime.mark((function t(n,r,o){var a,u,i,c,f,p,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,u=a.updateLite,i=a.update,c=a.stage,f=a.section,p=a.task,l=a.taskSchemaId,document.addEventListener("payment-accepted",s(regeneratorRuntime.mark((function t(){var n,r,o,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({popup:!1,purchased:!0,newValue:"Yes"}),t.next=3,u([{target:l,status:"waiting"}],{stage:c,section:f,task:p});case 3:return n=document.querySelector('form[data-stage="'+c+'"][data-section="'+f+'"][data-task="'+p+'"]'),r={},$.each($(n).serializeArray(),(function(){var e=this.name,t=this.value;r[e]=t})),t.next=8,i(c,f,p,r,!0);case 8:return o={method:"post",credentials:"include",body:JSON.stringify({task:l}),mode:"cors",headers:g},t.next=11,fetch(v.update,o);case 11:return a=t.sent,t.next=14,a.json();case 14:return s=t.sent,document.dispatchEvent(new CustomEvent("tasks-updated")),t.abrupt("return",s);case 17:case"end":return t.stop()}}),t)})))),"closed"===r&&e.setState({popup:!1}),"open"!==r){t.next=6;break}return t.next=6,o.applyStripe(n);case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),h(m(e),"handleChange",function(){var t=s(regeneratorRuntime.mark((function t(n){var o,i,c,s,f,p,l,d,y,m,b,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.props,i=o.enableConditions,c=o.updateLite,s=o.stage,f=o.section,p=o.task,l=o.id,d=o.price,!i){t.next=19;break}if(y=n.currentTarget.value,m=e.state.purchased,"Yes"!==y){t.next=13;break}return e.setState({disable:!0}),b=new a.default,t.next=9,b.getForm(l,d);case 9:h=t.sent,e.setState({disable:!1,popup:Object(r.h)(u.default,{title:"",content:h,open:!0,respond:function(t,n){return e.popupResponse(t,n,b)}})}),t.next=19;break;case 13:e.setState({popup:!1}),m&&(y="Yes"),v=[],i.forEach((function(e){y===e.thisValueIs&&v.push({target:e.target,status:e.updateTargetStatus,value:e.updateTargetValue})})),c(v,{stage:s,section:f,task:p}),e.setState({newValue:y});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),h(m(e),"html",(function(){var t=e.props,n=t.label,a=t.options,u=t.task,i=t.errors,c=t.id,s=t.value,f=t.disabled,p=e.state,l=p.popup,d=p.disable;if(d&&(f=!0),!s){var y=e.state.newValue;y&&(s=y)}return Object(r.h)("div",null,Object(r.h)("label",null,n),Object(r.h)("br",null),Object(r.h)("div",{className:"probate-machine__label-options"},a.map((function(t){return Object(r.h)("label",null,Object(r.h)("input",{"data-task":u,type:"radio",name:c,value:t,checked:t===s,disabled:f,onChange:e.handleChange}),t)})),!!d&&Object(r.h)("div",null,Object(r.h)("b",null,"Loading. Please wait..."))),Object(r.h)(o.default,{errors:i}),l)})),e}return t=y,(n=[{key:"render",value:function(){return this.html()}}])&&p(t.prototype,n),i&&p(t,i),y}(r.Component)}}]);
//# sourceMappingURL=4.71b2921ddb6c7058efad.js.map